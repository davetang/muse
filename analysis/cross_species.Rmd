---
title: "Convert gene symbols across species"
date: "`r Sys.Date()`"
output:
  workflowr::wflow_html:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Installation

To begin, install the {biomaRt} package.

```{r install_biomart, eval=FALSE}
if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("biomaRt")
```

## Package

Load package.

```{r load_biomart}
suppressPackageStartupMessages(library(biomaRt))
packageVersion("biomaRt")
```

## biomaRt

Adapted from <https://www.biostars.org/p/446641/>.

`getLDS()` retrieves information from two linked datasets; this function is the main {biomaRt} query function that links 2 datasets and retrieves information from these linked BioMart datasets. In Ensembl this translates to homology mapping.

```{r quick_start, error=TRUE}
human_us_mart <- useEnsembl(
  biomart = "ensembl",
  mirror = "useast",
  dataset = "hsapiens_gene_ensembl"
)

rat_us_mart <- useEnsembl(
  biomart = "ensembl",
  mirror = "useast",
  dataset = "rnorvegicus_gene_ensembl"
)

rat_genes <- c("Tll1", "Tlx3")

rat_to_human <- getLDS(
  attributes = c("rgd_symbol"), 
  filters = "rgd_symbol", 
  values = rat_genes, 
  mart = rat_us_mart, 
  attributesL = c("hgnc_symbol"), 
  martL = human_us_mart, 
  uniqueRows = TRUE
)

rat_to_human
```

Expected output:

```
#>   RGD.symbol HGNC.symbol
#> 1       Tll1        TLL1
#> 2       Tlx3        TLX3
```

## homologene

Install package.

```{r install_homologene, eval=FALSE}
install.packages("homologene")
```

Convert.

```{r homologene_convert}
suppressPackageStartupMessages(library(homologene))

# Convert human genes to rat genes
# 9606 = human
# 10116 = rat
human_genes <- homologene(
  rat_genes,
  inTax = 10116,
  outTax = 9606
)

human_genes
```
